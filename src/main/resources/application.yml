server:
  port: ${server.port:8080}
spring:
  application:
    name: FantasyMusic
  datasource:
    driver-class-name: ${spring.datasource.url}
    url: jdbc:mysql://${spring.datasource.mysql-connect.host}:${spring.datasource.mysql-connect.port}/fantasy_music?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
    username: ${spring.datasource.username}
    password: ${spring.datasource.password}
  data:
    redis:
      host: ${spring.data.redis.host}
      port: ${spring.data.redis.port}
      password: ${spring.data.redis.password}
      database: ${spring.data.redis.database}
  mail:
    host: ${spring.mail.host}
    port: ${spring.mail.port:25}
    username: ${spring.mail.username}
    password: ${spring.mail.password}
    default-encoding: UTF-8
    protocol: smtps  # <--- 显式指定协议为 smtps
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: false  # <--- 关闭 starttls (465端口不需要这个)
            required: false
          ssl:
            enable: true   # <--- 开启 SSL
          socketFactory: # <--- 指定 SSL Socket 工厂 (关键!)
            port: 465
            class: javax.net.ssl.SSLSocketFactory
            fallback: false
  profiles:
    active: prod # 默认使用项目目录下application-prod配置文件
  servlet:
    multipart:
      max-file-size: 100MB # 上传文件最大值
      max-request-size: 100MB # 上传请求最大值
mybatis-plus:
  configuration:
    # MyBatis 配置
    map-underscore-to-camel-case: true # 下划线转驼峰
    default-enum-type-handler: com.baomidou.mybatisplus.core.handlers.MybatisEnumTypeHandler # 全局枚举处理器
  global-config:
    # 全局配置
    db-config:
      # 数据库配置
      id-type: auto # 主键策略
logging:
  level:
    com.fantasy: debug
  file:
    name: logs/fantasy-music.log    # 相对路径，基于工作目录（JAR 所在目录）
  pattern:
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n"
  logback:
    rollingpolicy:
      max-file-size: 10MB           # 单个日志文件最大大小
      max-history: 30               # 保留 30 天的日志
      total-size-cap: 1GB           # 日志总大小上限
      clean-history-on-start: false
springdoc:
  api-docs:
    enabled: ${springdoc.api-docs.enabled}
    path: /v3/api-docs
  swagger-ui:
    enabled: ${springdoc.swagger-ui.enabled}
    path: /swagger-ui.html
    tags-sorter: alpha          # 标签按字母排序（支持中文拼音）
    operations-sorter: alpha    # 接口按字母排序
fm:
  jwt:
    secret-key: ${fm.jwt.secret-key}
    expire-time: ${fm.jwt.expire-time}
    token-name: ${fm.jwt.token-name}
  login:
    is-enable-password-encrypt: ${fm.login.is-enable-password-encrypt}
    private-key-string: ${fm.login.private-key-string}
  aliyunoss:
    endpoint: ${fm.aliyunoss.endpoint}
    bucket-name: ${fm.aliyunoss.bucket-name}
    access-key-id: ${fm.aliyunoss.access-key-id}
    access-key-secret: ${fm.aliyunoss.access-key-secret}
    expire-time: ${fm.aliyunoss.expire-time}
  mail:
    from: ${fm.mail.from}  # 直接引用 spring 的配置
    subject-prefix: ${fm.mail.subject-prefix}
    code-expire-minutes: ${fm.mail.code-expire-minutes}
